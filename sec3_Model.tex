%
% !TeX root =./main.tex
% !TeX spellcheck = en_US
\subsection{Matrix Representation of the Road Network}

For now, we consider the \textit{higher level road network} in Carinthia, Austria,
i.e., \textit{A}, \textit{S}, \textit{L}, \textit{B}, in the  form of a matrix.
The vertices of the matrix are the crossing points of the roads, while
the road section connecting those points form the edges of the matrix.
For each edge, we have the distance between the vertices and the length of the bridges along the segment
and the capacity constraints (and the lowest encountered bridge capacity).
This way, we can answer various questions concerning transports between those vertices.
Without loss of generality, we assume an undirected graph.
In that sense, the travel distance along an edge is independent of
the travel direction, and  the same bridges are surpassed in both directions.
The problem statement can
easily be extended to a directed graph. However, the authors omitted this for reasons of simplicity.

Classically,  the considered network $\mathcal{N}=(\mathcal{V},\mathcal{E})$ consists of
\begin{itemize}
  \item \emph{Nodes} (vertices) $\mathcal{V}=\{1,\ldots, n\}$, which represent the intersections of road
  well as the start (end) points of the roads, and

  \item \emph{Links} (edges) $\mathcal{E} \subseteq \mathcal{L} \times \mathcal{L}$,
  correspond to the roads (road segements) connecting the vertices.
\end{itemize}

Road links $e \in \mathcal{E}$ have a length $\ell(e)\in \mathbb{R}^{+}$ representing their road length.
Further, they have a weights $c(e) \in C$ giving their \emph{classification} according to {\color{red} ??}.
The classes $C$ describe the level of the roads {\color{red} ??},
while they have an ordering they are an dimensionless quantity.

Bridges (and other types of building structures that must be overpassed)
have \emph{weight limits} (measured in metric tons) which are determined by civil engineers.
Each road link $e \in \mathcal{E}$ contains a nonnegative number of bridges, where each has a weight limit.
For each link $e$, we set a \emph{weight limit} $w(e) \in \mathbb{R}^{+}$ which is the
minimum over all bridges on this link and the \emph{number of bridges} $b(e) \in \mathbb{N}^{0}$.
A weight limit $w(e)= \infty$ describes the circumstance
that no limit is given for $e$.
Similarly, we assume that nodes $v \in \mathcal{V}$ can have weight limits.
\begin{figure}[!ht]
  \centering
  \includegraphics[width=0.9\textwidth]{map.jpg}
  \caption{Overview of the higher level road network in Carinthia.}
  \label{fig:higher level}
\end{figure}


A simple toy example, see Figure \ref{fig_toy_example_1}, shall illustrate these definitions.
\begin{figure}[!ht]
  \centering
  \input{./figures/toy_network.tex}
  \caption{Toy Example 1.}
  \label{fig_toy_example_1}
\end{figure}


\subsection{Related Work on the Shortest Path Problem}

\citet{TACCARI2016122}

\subsection{Mathematical Model}

Next, we give an exact problem formulation.

\subsubsection{Feasible Subnetwork}
A \emph{transport request} $r=(o,d,w) \in \mathcal{V} \times \mathcal{V} \times \mathbb{R}^{+}$
has an \emph{origin} $s$, a \emph{destination} $t$, a \emph{total weight} $w$.

Clearly, a transport $r$ can only pass through nodes $v \in \mathcal{V}$ with
$w(r) \leq w(v)$ and traverse road links $e \in \mathcal{E}$ for which $w(r) \leq w(e)$ holds.

Accordingly, we define the sub-network $\mathcal{N}_{\omega}$ that contains only the vertices and edges from $\mathcal{N}$ that have a weight limit larger than $\omega \in \mathbb{R}^{+}$.
Hence, for the remainder of this manuscript, we set $\mathcal{N}=\mathcal{N}_{\omega=w(r)}$.

\subsubsection{Integer Programming Formulation}
In order to give an \emph{Integer Programming} (IP) formulation for we enumerate the
vertices $1,\ldots,|\mathcal{V}|$. We consider a directed graph $G=(\mathcal{V},\mathcal{E})$ that is derived from the network $\mathcal{N}$.
In that sense, the auxiliary variables $x_{ij}$, $(i,j) \in \mathcal{V}$
is set to $1$ if and only if node $j$ is visited directly after node $i$, and to $0$ otherwise.
A standard IP formulation to determine the shortest path between $s$ and $t$ can be given as follows
\begin{align}
  \min \quad &\sum_{(i,j)\in \mathcal{E}}  \c_{ij} x_{ij} \label{obj} \\
  \text{s.t.}\quad &
  \sum_{(i,j)\in \delta^{+} (i)} x_{ji} - \sum_{(i,j)\in \delta^{-}(i)} x_{ij} =
  \begin{cases}
    1 \quad& \text{if}~ i=s, \\
    -1 \quad& \text{if}~ i=t \\
    0 \quad&\text{else}
  \end{cases}
  \qquad \forall i \in \mathcal{E}
  \\
  &  \sum_{(i,j)\in \delta^{+} (i)} x_{ij}   x_ {ij} \leq 1     \qquad \forall i \in \mathcal{E}\\
  &  x_{ij} \in \{0,1\}   \qquad \forall (i,j) \in \mathcal{V}
\end{align}
The set of outgoing (ingoing) edges of vertex $i$ is denoted by  $\delta^{+} (i)$  $(\delta^{-} (i))$.


We consider three different objectives, i.e., different assignment of $c_{ij}$.
\begin{enumerate}
  \item \emph{Classic shortest path}, where $c_{ij}=\ell_{ij}$. \label{obj_short}
  \item \emph{Minimal number of surpassed briges}, where  $c_{ij}=b_{ij}$.  \label{obj_minBridge}
  \item \emph{Prefer high level roads}, where we assign an exponential weighting to the road classes (in ascending order of preference) $C$, $c_0=2^0,c_1=2^1, \ldots$.  \label{obj_highLevelRoad}
\end{enumerate}

\subsubsection{Solution Procedere}

As objective functions \ref{obj_short} and  \ref{obj_highLevelRoad}
use costs which induce no \emph{negative cycles}  on $G$, the problem can be efficiently solved
by polynomial-time algorithms like
\emph{Bellman-Ford's} \cite{Bell1958,Ford1956} or \emph{Dijistra's} \cite{dijkstra1959note} algorithm.
In case of \ref{obj:obj_minBridge}, links having no bridges ($b(e)=0$) can induce cycles which are of length zero.


% https://algs4.cs.princeton.edu/44sp/
% https://jgrapht.org/javadoc-SNAPSHOT/org.jgrapht.core/org/jgrapht/alg/shortestpath/DijkstraShortestPath.html
